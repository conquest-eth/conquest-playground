var n=Object.defineProperty;var o=Object.getOwnPropertySymbols;var f=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable;var h=(e,t,s)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,r=(e,t)=>{for(var s in t||(t={}))f.call(t,s)&&h(e,s,t[s]);if(o)for(var s of o(t))l.call(t,s)&&h(e,s,t[s]);return e};import{F as a}from"./vendor-e78c39f1.js";function c(e,t){for(const s of Object.keys(t))e[s]&&typeof e[s]=="object"&&typeof t[s]=="object"?c(e[s],t[s]):e[s]=t[s]}class b{constructor(t){this.value=t,this.oldValue=r({},t),this.store=a(this.value,this._start.bind(this))}get $store(){return this.value}_start(t){return this._stop.bind(this)}_stop(){}_set(t){let s=!1;if(!this.value)this.value=r({},t),s=!0;else{for(const i of Object.keys(this.oldValue))t[i]!==this.oldValue[i]&&(s=!0,this.value[i]=t[i]);for(const i of Object.keys(t))t[i]!==this.oldValue[i]&&(s=!0,this.value[i]=t[i])}s&&(this.oldValue=r({},this.value),this.store.set(this.value))}subscribe(t,s){return this.store.subscribe(t,s)}}class u{constructor(t){this.$store=t,this.store=a(this.$store)}subscribe(t,s){return this.store.subscribe(t,s)}setPartial(t){this.$store||(this.$store={});for(const s of Object.keys(t))this.$store[s]=t[s];return this.store.set(this.$store),this.$store}set(t){if(this.$store||(this.$store={}),t||(this.$store=t),t!==this.$store){for(const s of Object.keys(this.$store))t[s]===void 0&&(this.$store[s]=void 0);for(const s of Object.keys(t))this.$store[s]=t[s]}return this.store.set(this.$store),this.$store}}class p extends u{constructor(t){super(t)}setData(t,s){return this.$store.data=this.$store.data||{},c(this.$store.data,t),s&&this.setPartial(s),this.store.set(this.$store),this.$store}}class _ extends u{constructor(){super(...arguments);this._listenerCount=0}subscribe(t,s){this._listenerCount++,this._listenerCount===1&&(console.info("starting..."),this._stopUpdates=this._onStart());const i=this.store.subscribe(t,s);return()=>{this._listenerCount--,this._listenerCount===0&&(console.info("stopping"),this._stopUpdates&&(this._stopUpdates(),this._stopUpdates=void 0)),i()}}}export{_ as A,u as B,b as a,p as b};
//# sourceMappingURL=base-652be6d9.js.map
